#pragma once

#include "timer.h" // Nécessaire pour gérer les timers dans QMK

#define _DEFAULT 0
#define _PERCENT 1
#define _CODE 2
#define _IMAGE_SIZE 512

static const char PROGMEM logo[] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0xFC, 0x6C, 0x6C, 0x6C, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x03, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xFE,
    0x80, 0x80, 0x80, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x01, 0x01, 0x01, 0x01, 0x01,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x7F, 0xFF, 0x80, 0xC0,
    0xFF, 0x3E, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x80, 0x80, 0x80, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
    0xE0, 0xF0, 0x00, 0x00, 0x00, 0x00,
    0x1E, 0x7F, 0x61, 0x41, 0x79, 0x78,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
    0xE0, 0xF0, 0x78, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
    0xE0, 0xF0, 0x78, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x1E, 0x0F,
    0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
    0xE0, 0xF0, 0x78, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x1E, 0x0F,
    0x07, 0x03, 0x01, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x78, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x1E, 0x0F,
    0x07, 0x03, 0x01, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x9E, 0xCF,
    0xE7, 0xF3, 0x79, 0x3C, 0x1E, 0x0F,
    0x07, 0x03, 0x01, 0x00, 0x00, 0x00,
    0x80, 0x80, 0x80, 0x80, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x07, 0x03, 0x01, 0x00, 0x00, 0x00,
    0x80, 0xC0, 0xE0, 0x70, 0x38, 0x1C,
    0x0E, 0xE7, 0xF3, 0xF1, 0xF1, 0xF3,
    0xE7, 0x0E, 0x1C, 0x38, 0x70, 0xE0,
    0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0xF0, 0xF8, 0x9C,
    0x0E, 0x07, 0x63, 0xF1, 0xF8, 0xF8,
    0xF8, 0xF8, 0x60, 0x01, 0x03, 0x03,
    0x03, 0x03, 0x01, 0x60, 0xF0, 0xF8,
    0xF8, 0xF8, 0xF9, 0x63, 0x07, 0x0E,
    0x9C, 0xF8, 0xF0, 0x00, 0x00, 0x00,
    0x01, 0x03, 0x07, 0x0E, 0x1C, 0x38,
    0x71, 0xE1, 0xC1, 0x81, 0x00, 0x3C,
    0x7C, 0x7E, 0x7E, 0x7C, 0x3C, 0x00,
    0x80, 0xC1, 0xE1, 0x71, 0x39, 0x1C,
    0x0E, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x01, 0x03,
    0x07, 0x0E, 0x1C, 0x18, 0x18, 0x1C,
    0x0E, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00,
};

static const char layer_icons[][512] PROGMEM ={
    [_DEFAULT] = {
    0x00, 0x00, 0xF8, 0xF8, 0x18, 0x18,
    0x18, 0x38, 0xF0, 0xE0, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x7F, 0x7F,
    0x60, 0x60, 0x60, 0x70, 0x3F, 0x1F,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0xE0, 0xE0, 0x68, 0x6E, 0x66,
    0x60, 0x60, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0xFF, 0xFF, 0x8C,
    0x8C, 0x8C, 0x8C, 0x84, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x81,
    0x81, 0x81, 0x81, 0x81, 0x81, 0x81,
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0xFF, 0xFF, 0x31, 0x31, 0x31,
    0x31, 0x11, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x07, 0x07, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xE0,
    0xFC, 0x1E, 0x0E, 0xFE, 0xF0, 0x80,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
    0x1F, 0x1F, 0x03, 0x03, 0x03, 0x03,
    0x07, 0x1F, 0x1C, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xF8, 0xF8, 0x00, 0x00,
    0x00, 0x00, 0xF8, 0xF8, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x1F, 0x7F,
    0x60, 0x60, 0xC0, 0x60, 0x7F, 0x3F,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x00, 0x00,
    0x60, 0x60, 0x60, 0xE0, 0xE0, 0x60,
    0x60, 0x60, 0x20, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xFF,
    0xFF, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE1, 0xF1, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00,
},
[_PERCENT]={
    0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
    0xE0, 0x60, 0x70, 0x30, 0x30, 0x30,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x60, 0xFE,
    0xFF, 0x1F, 0x0C, 0x0C, 0x0C, 0x1C,
    0xFC, 0xF8, 0xF0, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x03, 0x87, 0xCF, 0xCC, 0xFC,
    0xFC, 0xCC, 0xCF, 0x87, 0x03, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xF8, 0xFF, 0xFF, 0x03,
    0x70, 0x70, 0x70, 0x21, 0x0F, 0xFF,
    0xFE, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x01, 0x0F,
    0x9F, 0xBC, 0x30, 0x70, 0x70, 0x38,
    0x3F, 0x1F, 0x07, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x7F, 0xFF, 0xC1, 0xFF, 0x7F, 0xD8,
    0xE0, 0x78, 0x3C, 0x0F, 0x03, 0x01,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x80, 0xE0, 0x78, 0x3C,
    0x0F, 0x03, 0x7D, 0xFF, 0xC3, 0xC3,
    0xFF, 0x7C, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x01, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00,
}  ,
[_CODE] = {
    0x00, 0x00, 0xC0, 0xF0, 0x78, 0x18,
    0x18, 0x1C, 0x18, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x0F, 0x3F,
    0x78, 0x60, 0x60, 0xE0, 0x60, 0x60,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x80, 0xE0, 0x60, 0x70, 0x30, 0x60,
    0xE0, 0xC0, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x7F, 0xFF, 0x80, 0x80,
    0x80, 0x80, 0xFF, 0xFF, 0x3F, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
    0x81, 0x81, 0x83, 0x81, 0x01, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xFF, 0xFF, 0x01, 0x01, 0x01, 0x03,
    0xFF, 0xFE, 0x30, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x07, 0x07, 0x06, 0x06,
    0x06, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xFE,
    0xFE, 0xC6, 0xC6, 0xC6, 0xC6, 0x46,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x1F, 0x1F, 0x18, 0x18, 0x18,
    0x18, 0x18, 0x10, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x00, 0x00, 0x00, 0x80,
    0xC0, 0xE0, 0xF0, 0x78, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x9E,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xCF, 0xE7, 0xF3, 0x79, 0x3C, 0x1E,
    0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00,
}

};

// Variables pour gérer le dé-bouncing des encodeurs
static uint32_t last_encoder_update_time[2] = {0, 0}; // Deux encodeurs
const uint32_t encoder_update_interval = 50; // Intervalle minimal entre deux mises à jour en millisecondes

// Variables pour gérer l'affichage des couches actives
static uint8_t current_layer = 0;

bool oled_task_user(void) {
    if (!is_keyboard_master()) {
        // Affiche le logo sur l'écran principal (côté maître)
        oled_write_raw_P(logo, sizeof(logo));
    } 
    return false; // Empêche le dessin par défaut du clavier
}

bool encoder_update_user(uint8_t index, bool clockwise) {
    uint32_t current_time = timer_read32();
    if (current_time - last_encoder_update_time[index] < encoder_update_interval) {
        // Trop tôt depuis la dernière mise à jour
        return false;
    }
    last_encoder_update_time[index] = current_time;

    if (index == 0) { // Encodeur de gauche
        if (clockwise) {
            tap_code(KC_WH_U); // Mouse Wheel Up
        } else {
            tap_code(KC_WH_D); // Mouse Wheel Down
        }
    } else if (index == 1) { // Encodeur de droite
        if (clockwise) {
            current_layer = (current_layer + 1) % 3; // Passe à la couche suivante (0 -> 1 -> 4 -> 0)
            layer_move(current_layer);
        } else {
            current_layer = (current_layer == 0) ? 2 : current_layer - 1; // Reviens à la couche précédente
            layer_move(current_layer);
        }
    }

    return true; // Indique que l'action est gérée ici
}

layer_state_t layer_state_set_user(layer_state_t state) {
    if (!is_keyboard_master()) {
        return state; // S'assure que cette partie ne tourne que sur le maître
    }

    switch (get_highest_layer(state)) {
        case 0:
            oled_write_raw_P(layer_icons[_DEFAULT], size(layer_icons[_DEFAULT]));
            break;
        case 1:
            oled_write_raw_P(layer_icons[_PERCENT], size(layer_icons[_PERCENT]));
            break;
        case 4:
            oled_write_raw_P(layer_icons[_CODE], size(layer_icons[_CODE]));
            break;
        default:
            oled_write_ln_P(PSTR("Inconnu"), false);
            break;
    }

    return state;
}